

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1.5. Scipy: computación científica de alto nivel &mdash; Scipy lecture notes</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2013.2 beta (euroscipy 2013)',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="top" title="Scipy lecture notes" href="../index.html" />
    <link rel="up" title="1. Iniciandose en computación científica con Python" href="index.html" />
    <link rel="next" title="1.5.11.13. Maximum wind speed prediction at the Sprogø station" href="summary-exercises/stats-interpolate.html" />
    <link rel="prev" title="1.4. Matplotlib: Gráficas usando pylab" href="matplotlib/matplotlib.html" /> 
  </head>
  <body>
   <!-- Use the header to add javascript -->
    
    <script type="text/javascript">
    // Function to collapse the tip divs
    function collapse_tip_div(obj){
	// Update the representation on the tip div based on whether it
	// has the 'collapsed' css class or not: we only want to
	// collapse divs that are not already collapsed
	if($(obj).hasClass("collapsed")) {
	} else {
	    $(obj).find("p.summary").remove();
	    var content = $(obj).text();
	    var html = $(obj).html();

	    if(content.length > 40) {
		if ($.browser.msie) {
		    // We start at '3' to avoid 'tip', as IE
		    // does not count whitespace
		    var content = content.substr(3, 50);
		} else {
		    // We start at '5' to avoid 'tip '
		    var content = content.substr(5, 50);
		}
	    }
	    $(obj).html('<p class="summary"><img src="../_static/plus.png">' + content + '...</p>' + html);
	}
    }
    </script>

    <script type="text/javascript">
    $(function () {
	$(".tip")
	    .click(function(event){
		$(this).toggleClass("collapsed");
		// Change state of the global button
		$('div.related li.transparent').removeClass('transparent')
		$(this).find("p.summary").remove();
		if($(this).hasClass("collapsed")) {
		    var content = $(this).text();
		    var html = $(this).html();
    
		    if(content.length > 40) {
			if ($.browser.msie) {
			    // We start at '3' to avoid 'tip', as IE
			    // does not count whitespace
			    var content = content.substr(3, 50);
			} else {
			    // We start at '5' to avoid 'tip '
			    var content = content.substr(5, 50);
			}
		    }
		    $(this).html('<p class="summary"><img src="../_static/plus.png">' + content + '...</p>' + html);
		}
		if (event.target.tagName.toLowerCase() != "a") {
                   return true; //Makes links clickable
		}
	});
    });
    </script>


    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="summary-exercises/stats-interpolate.html" title="1.5.11.13. Maximum wind speed prediction at the Sprogø station"
             accesskey="N">siguiente</a></li>
        <li class="right" >
          <a href="matplotlib/matplotlib.html" title="1.4. Matplotlib: Gráficas usando pylab"
             accesskey="P">anterior</a> |</li>
        <li><a href="../index.html">Scipy lecture notes</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">1. Iniciandose en computación científica con Python</a> &raquo;</li>
     
    <!-- Insert a menu in the navigation bar -->
    <li class="left">
	<!-- On click toggle the 'tip' on or off-->
	<a onclick="$('.tip').each(function (index, obj) {
			    collapse_tip_div(obj);
		    });
		    $('.tip').addClass('collapsed');
		    $('.left').addClass('transparent');">
	<img src="../_static/minus.png"
         alt="Collapse to compact view" style="padding: 1ex;"/>
	<span class="hiddenlink">Collapse document to compact view</span>
    </a></li>

      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="scipy-computacion-cientifica-de-alto-nivel">
<h1>1.5. Scipy: computación científica de alto nivel<a class="headerlink" href="#scipy-computacion-cientifica-de-alto-nivel" title="Enlazar permanentemente con este título">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Autores:</th><td class="field-body">Adrien Chauve, Andre Espaze, Emmanuelle Gouillart,
Gaël Varoquaux, Ralf Gommers</td>
</tr>
</tbody>
</table>
<div class="topic">
<p class="topic-title first">Scipy</p>
<p>El paquete <tt class="docutils literal"><span class="pre">scipy</span></tt> contiene varias cajas de herramientas dedicadas a problemas comunes problemas en computación científica. Sus diferentes submódulos corresponden a diferentes aplicaciones, tales como interpolación, integración, optimización, procesamiento de imágenes, estadística, funciones especiales, etc.</p>
<p><tt class="docutils literal"><span class="pre">scipy</span></tt> se puede comparar con otras bibliotecas estándar de computación científica, como GSL (GNU Scientific Library para C y C++), o cajas de herramientas de Matlab. <tt class="docutils literal"><span class="pre">scipy</span></tt> es el paquete núcleo para rutinas científicas en Python; operando de manera eficiente los arreglos <tt class="docutils literal"><span class="pre">numpy</span></tt>, por tanto numpy y scipy trabajan mano a mano.</p>
<p>Antes de implementar una rutina, hay que comprobar si no está implementado en Scipy. Como programadores no profesionales, los científicos a menudo tienden a <strong>reinventar la rueda</strong>, lo que conduce a errores en el código, código no optimizado, código difícil de compartir e imposible de mantener. Por el contrario, las rutinas que contiene <tt class="docutils literal"><span class="pre">Scipy</span></tt> están optimizadas y probadas, por lo tanto se debe utilizar siempre que sea posible.</p>
</div>
<div class="contents local topic" id="contenido">
<p class="topic-title first">Contenido</p>
<ul class="simple">
<li><a class="reference internal" href="#entrada-salida-de-archivos-scipy-io" id="id1">Entrada/salida de archivos: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/io.html#scipy.io" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.io</span></tt></a></a></li>
<li><a class="reference internal" href="#funciones-especiales-scipy-special" id="id2">Funciones especiales: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/special.html#scipy.special" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.special</span></tt></a></a></li>
<li><a class="reference internal" href="#operaciones-de-algebra-lineal-scipy-linalg" id="id3">Operaciones de álgebra lineal: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/linalg.html#scipy.linalg" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.linalg</span></tt></a></a></li>
<li><a class="reference internal" href="#transformada-rapida-de-fourier-scipy-fftpack" id="id4">Transformada rápida de Fourier: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/fftpack.html#scipy.fftpack" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.fftpack</span></tt></a></a></li>
<li><a class="reference internal" href="#optimizacion-y-ajuste-scipy-optimize" id="id5">Optimización y ajuste: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/optimize.html#scipy.optimize" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.optimize</span></tt></a></a></li>
<li><a class="reference internal" href="#estadistica-y-numeros-aleatorios-scipy-stats" id="id6">Estadística y números aleatorios: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/stats.html#scipy.stats" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.stats</span></tt></a></a></li>
<li><a class="reference internal" href="#interpolacion-scipy-interpolate" id="id7">Interpolación: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/interpolate.html#scipy.interpolate" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.interpolate</span></tt></a></a></li>
<li><a class="reference internal" href="#integracion-numerica-scipy-integrate" id="id8">Integración numérica: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/integrate.html#scipy.integrate" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.integrate</span></tt></a></a></li>
<li><a class="reference internal" href="#procesamiento-de-senales-scipy-signal" id="id9">Procesamiento de señales: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/signal.html#scipy.signal" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.signal</span></tt></a></a></li>
<li><a class="reference internal" href="#procesamiento-de-imagenes-scipy-ndimage" id="id10">Procesamiento de imágenes: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/ndimage.html#scipy.ndimage" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.ndimage</span></tt></a></a></li>
<li><a class="reference internal" href="#sumario-de-ejercicios-para-computacion-cientifica" id="id11">Sumario de ejercicios para computación científica</a></li>
</ul>
</div>
<div class="admonition warning">
<p class="first admonition-title">Advertencia</p>
<p class="last">Este tutorial está lejos de ser una introducción a métodos numéricos. Enumerar los diferentes submódulos y funciones en scipy seria muy aburrido, en cambio nos concentramos en algunos ejemplos para dar una idea general de cómo utilizar <tt class="docutils literal"><span class="pre">scipy</span></tt>  para computación científica.</p>
</div>
<p><tt class="xref py py-mod docutils literal"><span class="pre">scipy</span></tt> contiene sub-módulos para tareas específicas:</p>
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/cluster.html#scipy.cluster" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.cluster</span></tt></a></td>
<td>Vector quantization / Kmeans</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/constants.html#scipy.constants" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.constants</span></tt></a></td>
<td>Constantes físicas y matemáticas</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/fftpack.html#scipy.fftpack" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.fftpack</span></tt></a></td>
<td>Transformadas de Fourier</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/integrate.html#scipy.integrate" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.integrate</span></tt></a></td>
<td>Rutinas para integración</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/interpolate.html#scipy.interpolate" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.interpolate</span></tt></a></td>
<td>Interpolación</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/io.html#scipy.io" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.io</span></tt></a></td>
<td>Entrada y salida</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/linalg.html#scipy.linalg" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.linalg</span></tt></a></td>
<td>Rutinas para algebra lineal</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/ndimage.html#scipy.ndimage" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.ndimage</span></tt></a></td>
<td>n-dimensional image package</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/odr.html#scipy.odr" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.odr</span></tt></a></td>
<td>Orthogonal distance regression</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/optimize.html#scipy.optimize" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.optimize</span></tt></a></td>
<td>Optimización</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/signal.html#scipy.signal" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.signal</span></tt></a></td>
<td>Procesamiento de señales</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/sparse.html#scipy.sparse" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.sparse</span></tt></a></td>
<td>Matrices dispersas</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/spatial.html#scipy.spatial" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.spatial</span></tt></a></td>
<td>estructuras de datos espaciales y algoritmos</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/special.html#scipy.special" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.special</span></tt></a></td>
<td>Funciones matemáticas especiales</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/stats.html#scipy.stats" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.stats</span></tt></a></td>
<td>Estadística</td>
</tr>
</tbody>
</table>
<p>Todos ellos dependen de <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/index.html#numpy" title="(in NumPy v1.7)"><tt class="xref py py-mod docutils literal"><span class="pre">numpy</span></tt></a>, en su mayoría son independientes el uno del otro. La forma estándar de importar Numpy y módulos Scipy es</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>  <span class="c"># lo mismo para otros submódulos</span>
<div class="newline"></div></pre></div>
</div>
<p>El espacio de nombres principal <tt class="docutils literal"><span class="pre">scipy</span></tt> que contiene la mayoría de las funciones son en realidad funciones numpy (pruebe <tt class="docutils literal"><span class="pre">scipy.cos</span> <span class="pre">is</span> <span class="pre">np.cos</span></tt>). Están expuestos por razones solamente históricas, por lo general no hay ninguna razón para utilizar <tt class="docutils literal"><span class="pre">import</span> <span class="pre">scipy</span></tt> en su código.</p>
<div class="section" id="entrada-salida-de-archivos-scipy-io">
<h2><a class="toc-backref" href="#id1">1.5.1. Entrada/salida de archivos: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/io.html#scipy.io" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.io</span></tt></a></a><a class="headerlink" href="#entrada-salida-de-archivos-scipy-io" title="Enlazar permanentemente con este título">¶</a></h2>
<ul>
<li><p class="first">Cargar y guardar archivos de matlab</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">io</span> <span class="k">as</span> <span class="n">spio</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">spio</span><span class="o">.</span><span class="n">savemat</span><span class="p">(</span><span class="s">&#39;file.mat&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">})</span> <span class="c"># savemat espera un diccionario</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">spio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="s">&#39;file.mat&#39;</span><span class="p">,</span> <span class="n">struct_as_record</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span>
<div class="newline"></div><span class="go">array([[ 1.,  1.,  1.],</span>
<div class="newline"></div><span class="go">       [ 1.,  1.,  1.],</span>
<div class="newline"></div><span class="go">       [ 1.,  1.,  1.]])</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first">Lectura de imágenes</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">misc</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">misc</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s">&#39;fname.png&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c"># Matplotlib tiene una función similar</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s">&#39;fname.png&#39;</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
</li>
</ul>
<p>Ver también:</p>
<ul class="simple">
<li>Cargar archivos de texto: <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.loadtxt.html#numpy.loadtxt" title="(in NumPy v1.7)"><tt class="xref py py-func docutils literal"><span class="pre">numpy.loadtxt()</span></tt></a>/<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.savetxt.html#numpy.savetxt" title="(in NumPy v1.7)"><tt class="xref py py-func docutils literal"><span class="pre">numpy.savetxt()</span></tt></a></li>
<li>Cargar archivos de texto/csv de forma hábil: <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.genfromtxt.html#numpy.genfromtxt" title="(in NumPy v1.7)"><tt class="xref py py-func docutils literal"><span class="pre">numpy.genfromtxt()</span></tt></a>/<tt class="xref py py-func docutils literal"><span class="pre">numpy.recfromcsv()</span></tt></li>
<li>Rápido y eficiente, formato propio de numpy en archivo binario: <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.save.html#numpy.save" title="(in NumPy v1.7)"><tt class="xref py py-func docutils literal"><span class="pre">numpy.save()</span></tt></a>/<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.load.html#numpy.load" title="(in NumPy v1.7)"><tt class="xref py py-func docutils literal"><span class="pre">numpy.load()</span></tt></a></li>
</ul>
</div>
<div class="section" id="funciones-especiales-scipy-special">
<h2><a class="toc-backref" href="#id2">1.5.2. Funciones especiales: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/special.html#scipy.special" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.special</span></tt></a></a><a class="headerlink" href="#funciones-especiales-scipy-special" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Las funciones especiales son funciones trascendentales. La cadena de documentación del módulo <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/special.html#scipy.special" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.special</span></tt></a> está bien escrita, así que no vamos a enumerar todas las
funciones aquí. Los frecuentemente utilizadas son:</p>
<ul class="simple">
<li>Función de Bessel, tales como <tt class="xref py py-func docutils literal"><span class="pre">scipy.special.jn()</span></tt> (función de Bessel de enésimo orden)</li>
<li>Función elíptica (<tt class="xref py py-func docutils literal"><span class="pre">scipy.special.ellipj()</span></tt> para la función elíptica jacobiana, ...)</li>
<li>Función Gamma: <tt class="xref py py-func docutils literal"><span class="pre">scipy.special.gamma()</span></tt>, también tenga en cuenta <tt class="xref py py-func docutils literal"><span class="pre">scipy.special.gammaln()</span></tt> dará el registro de Gamma con una mayor precisión numérica.</li>
<li>Erf, la función error o el área bajo la curva de Gauss: <tt class="xref py py-func docutils literal"><span class="pre">scipy.special.erf()</span></tt></li>
</ul>
</div>
<div class="section" id="operaciones-de-algebra-lineal-scipy-linalg">
<span id="scipy-linalg"></span><h2><a class="toc-backref" href="#id3">1.5.3. Operaciones de álgebra lineal: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/linalg.html#scipy.linalg" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.linalg</span></tt></a></a><a class="headerlink" href="#operaciones-de-algebra-lineal-scipy-linalg" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El módulo <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/linalg.html#scipy.linalg" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.linalg</span></tt></a> ofrece operaciones estándar para álgebra lineal, basándose en una aplicación eficiente subyacente (BLAS, LAPACK).</p>
<ul>
<li><p class="first">El función <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.det.html#scipy.linalg.det" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.linalg.det()</span></tt></a> calcula el determinante de una matriz cuadrada</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>                <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<div class="newline"></div><span class="go">-2.0</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>                <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<div class="newline"></div><span class="go">0.0</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<div class="newline"></div><span class="gt">Traceback (most recent call last):</span>
<div class="newline"></div><span class="c">...</span>
<div class="newline"></div><span class="gr">ValueError</span>: <span class="n">expected square matrix</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first">La función <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.inv.html#scipy.linalg.inv" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.linalg.inv()</span></tt></a> calcula la inversa de una matriz cuadrada</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>                <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">iarr</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">iarr</span>
<div class="newline"></div><span class="go">array([[-2. ,  1. ],</span>
<div class="newline"></div><span class="go">       [ 1.5, -0.5]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">iarr</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>Finalmente calcular la inversa de una matriz singular (su determinante es cero) generará un error <tt class="docutils literal"><span class="pre">LinAlgError</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>                <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<div class="newline"></div><span class="gt">Traceback (most recent call last):</span>
<div class="newline"></div><span class="c">...</span>
<div class="newline"></div><span class="gr">LinAlgError</span>: <span class="n">singular matrix</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first">Operaciones más avanzadas están disponibles, por ejemplo descomposición en valores singulares (SVD)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">uarr</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">vharr</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>Los valores propios son</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span>    
<div class="newline"></div><span class="go">array([ 14.88982544,   0.45294236,   0.29654967])</span>
<div class="newline"></div></pre></div>
</div>
<p>La matriz original puede ser obtenida mediante multiplicación matricial de los resultados de <tt class="docutils literal"><span class="pre">svd</span></tt> con <tt class="docutils literal"><span class="pre">np.dot</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sarr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">svd_mat</span> <span class="o">=</span> <span class="n">uarr</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sarr</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vharr</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">svd_mat</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>SVD se utiliza comúnmente en estadística y procesamiento de señales. Otros métodos de descomposiciones estándar están disponibles (QR, LU, Cholesky, Schur), támbien solucionadores de sistemas lineales, están disponibles en <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/linalg.html#scipy.linalg" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.linalg</span></tt></a>.</p>
</li>
</ul>
</div>
<div class="section" id="transformada-rapida-de-fourier-scipy-fftpack">
<h2><a class="toc-backref" href="#id4">1.5.4. Transformada rápida de Fourier: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/fftpack.html#scipy.fftpack" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.fftpack</span></tt></a></a><a class="headerlink" href="#transformada-rapida-de-fourier-scipy-fftpack" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El módulo <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/fftpack.html#scipy.fftpack" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.fftpack</span></tt></a> permite calcular la transformada rápida de Fourier. A modo de ejemplo, una señal de entrada (con ruido) puede verse</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">time_step</span> <span class="o">=</span> <span class="mf">0.02</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">period</span> <span class="o">=</span> <span class="mf">5.</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">time_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">time_step</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">period</span> <span class="o">*</span> <span class="n">time_vec</span><span class="p">)</span> <span class="o">+</span> \
<div class="newline"></div><span class="gp">... </span>      <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">time_vec</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>El observador no conoce la frecuencia de la señal, sólo el paso de tiempo de muestreo de la señal <tt class="docutils literal"><span class="pre">sig</span></tt>. La señal se supone que procede de una función real para la cual la transformada de Fourier será simétrica.
La función <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.fftpack.fftfreq.html#scipy.fftpack.fftfreq" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.fftpack.fftfreq()</span></tt></a> genera las frecuencias de muestreo y <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.fftpack.fft.html#scipy.fftpack.fft" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.fftpack.fft()</span></tt></a> calcula la transformada rápida de Fourier</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">fftpack</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sample_freq</span> <span class="o">=</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">time_step</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sig_fft</span> <span class="o">=</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>Debido a que la potencia resultante es simétrica, sólo la parte positiva del espectro es utilizada para encontrar la frecuencia</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">pidxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sample_freq</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">freqs</span> <span class="o">=</span> <span class="n">sample_freq</span><span class="p">[</span><span class="n">pidxs</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sig_fft</span><span class="p">)[</span><span class="n">pidxs</span><span class="p">]</span>
<div class="newline"></div></pre></div>
</div>
<p>[<a class="reference external" href="../plot_directive/pyplots/fftpack_frequency.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/fftpack_frequency.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/fftpack_frequency.pdf">pdf</a>]</p>
<a class="reference internal image-reference" href="../_images/fftpack_frequency.png"><img alt="../_images/fftpack_frequency.png" src="../_images/fftpack_frequency.png" style="width: 308.0px; height: 252.0px;" /></a>
<p>La frecuencia de la señal se puede encontrar</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span> <span class="o">=</span> <span class="n">freqs</span><span class="p">[</span><span class="n">power</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="n">period</span><span class="p">)</span>  <span class="c"># check that correct freq is found</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>Ahora, el ruido de alta frecuencia será eliminado de la señal transformada de Fourier</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sig_fft</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sample_freq</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">freq</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<div class="newline"></div></pre></div>
</div>
<p>La señal filtrada resultante puede ser calculado con la función <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.fftpack.ifft.html#scipy.fftpack.ifft" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.fftpack.ifft()</span></tt></a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">main_sig</span> <span class="o">=</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">sig_fft</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>El resultado se puede ver con</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pylab</span> <span class="kn">as</span> <span class="nn">plt</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_vec</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_vec</span><span class="p">,</span> <span class="n">main_sig</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Time [s]&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Amplitude&#39;</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>[<a class="reference external" href="../plot_directive/pyplots/fftpack_signals.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/fftpack_signals.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/fftpack_signals.pdf">pdf</a>]</p>
<a class="reference internal image-reference" href="../_images/fftpack_signals.png"><img alt="../_images/fftpack_signals.png" src="../_images/fftpack_signals.png" style="width: 308.0px; height: 252.0px;" /></a>
<div class="topic">
<p class="topic-title first"><a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/routines.fft.html#numpy.fft" title="(in NumPy v1.7)"><tt class="xref py py-obj docutils literal"><span class="pre">numpy.fft</span></tt></a></p>
<p>Numpy también tiene una implementación de FFT (<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/routines.fft.html#numpy.fft" title="(in NumPy v1.7)"><tt class="xref py py-mod docutils literal"><span class="pre">numpy.fft</span></tt></a>). Sin embargo, en general es preferible usar <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/fftpack.html#scipy.fftpack" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.fftpack</span></tt></a>, ya que utiliza implementaciones subyacentes más eficientes.</p>
</div>
<div class="topic">
<p class="topic-title first">Ejemplo práctico: Encontrar periodicidad cruda</p>
<p>[<a class="reference external" href="../plot_directive/intro/solutions/periodicity_finder.py">source code</a>, <a class="reference external" href="../plot_directive/intro/solutions/periodicity_finder_00.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/intro/solutions/periodicity_finder_00.pdf">pdf</a>]</p>
<img alt="../_images/periodicity_finder_00.png" src="../_images/periodicity_finder_00.png" />
<p>[<a class="reference external" href="../plot_directive/intro/solutions/periodicity_finder.py">source code</a>, <a class="reference external" href="../plot_directive/intro/solutions/periodicity_finder_01.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/intro/solutions/periodicity_finder_01.pdf">pdf</a>]</p>
<img alt="../_images/periodicity_finder_01.png" src="../_images/periodicity_finder_01.png" />
</div>
<div class="topic">
<p class="topic-title first">Ejemplo práctico: Gaussian image blur</p>
<p>Convolución:</p>
<div class="math">
<p><img src="../_images/math/8a0d820c0f23dceec498bfe04920ac8892044ded.png" alt="f_1(t) = \int dt'\, K(t-t') f_0(t')"/></p>
</div><div class="math">
<p><img src="../_images/math/6ce1d529b80698bcaf26a9478845e3ba42a83028.png" alt="\tilde{f}_1(\omega) = \tilde{K}(\omega) \tilde{f}_0(\omega)"/></p>
</div><p>[<a class="reference external" href="../plot_directive/intro/solutions/image_blur.py">source code</a>, <a class="reference external" href="../plot_directive/intro/solutions/image_blur.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/intro/solutions/image_blur.pdf">pdf</a>]</p>
<img alt="../_images/image_blur.png" src="../_images/image_blur.png" />
</div>
<div class="green topic">
<p class="topic-title first">Ejercicio: Imagen de alunizaje con ruido</p>
<a class="reference internal image-reference" href="../_images/moonlanding.png"><img alt="../_images/moonlanding.png" src="../_images/moonlanding.png" style="width: 441.0px; height: 331.8px;" /></a>
<ol class="arabic simple">
<li>Examine la imagen moonlanding.png proporcionada, que está en gran medida
contaminada con ruido periódico. En este ejercicio, nuestro objetivo es limpiar
el ruido utilizando la transformada rápida de Fourier.</li>
<li>Cargar la imagen usando <tt class="xref py py-func docutils literal"><span class="pre">pylab.imread()</span></tt>.</li>
<li>Encontrar y utilizar la función FFT 2-D en <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/fftpack.html#scipy.fftpack" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.fftpack</span></tt></a>, y graficar el
espectro de la imagen (de la transformada de Fourier). Tiene algún problema
en visualizar el espectro? Si es así, porqué?</li>
<li>El espectro consta de componentes de alta y baja frecuencia. El ruido está contenida en la parte de alta frecuencia del espectro, por lo que se debe establecer algunos de sus componentes a cero (use segmentado de arreglos o slicing).</li>
<li>Aplicar la transformada inversa de Fourier para ver la imagen resultante.</li>
</ol>
</div>
</div>
<div class="section" id="optimizacion-y-ajuste-scipy-optimize">
<h2><a class="toc-backref" href="#id5">1.5.5. Optimización y ajuste: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/optimize.html#scipy.optimize" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.optimize</span></tt></a></a><a class="headerlink" href="#optimizacion-y-ajuste-scipy-optimize" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Optimización es el problema de encontrar una solución numérica a un
minimización o igualdad.</p>
<p>El módulo <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/optimize.html#scipy.optimize" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.optimize</span></tt></a> proporciona algoritmos útiles para la minimización de funciones (escalares o multidimensionales), ajuste de curvas y búsqueda de raices.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<div class="newline"></div></pre></div>
</div>
<p><strong>Encontrar los mínimos de una función escalar</strong></p>
<p>Vamos a definir la siguiente función:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>y la graficamos:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> 
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
<div class="newline"></div></pre></div>
</div>
<p>[<a class="reference external" href="../plot_directive/pyplots/scipy_optimize_example1.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/scipy_optimize_example1.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/scipy_optimize_example1.pdf">pdf</a>]</p>
<img alt="../_images/scipy_optimize_example1.png" src="../_images/scipy_optimize_example1.png" />
<p>Esta función tiene un mínimo global en torno a -1.3 y un mínimo local en torno a 3.8.</p>
<p>La forma general y eficiente para encontrar el mínimo de esta función es llevar a cabo un descenso de gradiente partiendo de un punto inicial dado. El algoritmo BFGS es una buena manera de hacer esto</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">optimize</span><span class="o">.</span><span class="n">fmin_bfgs</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<div class="newline"></div><span class="go">Optimization terminated successfully.</span>
<div class="newline"></div><span class="go">         Current function value: -7.945823</span>
<div class="newline"></div><span class="go">         Iterations: 5</span>
<div class="newline"></div><span class="go">         Function evaluations: 24</span>
<div class="newline"></div><span class="go">         Gradient evaluations: 8</span>
<div class="newline"></div><span class="go">array([-1.30644003])</span>
<div class="newline"></div></pre></div>
</div>
<p>Un posible problema con este enfoque es, si la función tiene mínimos locales
el algoritmo puede encontrar estos mínimos locales en lugar de los mínimos globales de pendiendo del punto inicial:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">optimize</span><span class="o">.</span><span class="n">fmin_bfgs</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([ 3.83746663])</span>
<div class="newline"></div></pre></div>
</div>
<p>Si no conocemos el intérvalo del mínimo global para elegir el punto inicial, tenemos que recurrir a una más costoso optimización global. Para encontrar el mínimo global, el algoritmo más simple es el algoritmo de fuerza bruta, en la que el
la función se evalúa en cada punto de una cuadrícula:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">grid</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">xmin_global</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brute</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">grid</span><span class="p">,))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">xmin_global</span>
<div class="newline"></div><span class="go">array([-1.30641113])</span>
<div class="newline"></div></pre></div>
</div>
<p>Para tamaños de cuadrícula más grandes, <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.brute.html#scipy.optimize.brute" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.optimize.brute()</span></tt></a> se vuelve muy lento. <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.anneal.html#scipy.optimize.anneal" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.optimize.anneal()</span></tt></a> ofrece una alternativa, utilizando recocido simulado. Existen algoritmos más eficientes para diferentes tipos de problemas de optimización global, pero están fuera del alcance de <tt class="docutils literal"><span class="pre">scipy</span></tt>. Algunos paquetes útiles para optimización global son <a class="reference external" href="http://openopt.org/Welcome">OpenOpt</a>, <a class="reference external" href="https://github.com/xuy/pyipopt">IPOPT</a>, <a class="reference external" href="http://pagmo.sourceforge.net/pygmo/index.html">PyGMO</a> y <a class="reference external" href="http://pyevolve.sourceforge.net/">PyEvolve</a>.</p>
<p>Para encontrar el mínimo local, vamos a restringir la variable en el intervalo
<tt class="docutils literal"><span class="pre">(0,</span> <span class="pre">10)</span></tt> usando <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fminbound.html#scipy.optimize.fminbound" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.optimize.fminbound()</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">xmin_local</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fminbound</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>    
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">xmin_local</span>
<div class="newline"></div><span class="go">3.8374671...</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">Encontrar los mínimos de una función se discute con más detalles en el capítulo avanzado: <a class="reference internal" href="../advanced/mathematical_optimization/index.html#mathematical-optimization"><em>Mathematical optimization: finding minima of functions</em></a>.</p>
</div>
<p><strong>Encontrar las raíces de una función escalar</strong></p>
<p>Para encontrar una raíz, o el punto donde <tt class="docutils literal"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">0</span></tt>, de la función <tt class="docutils literal"><span class="pre">f</span></tt> de arriba
podemos utilizar por ejemplo <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fsolve.html#scipy.optimize.fsolve" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.optimize.fsolve()</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c"># our initial guess is 1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">root</span>
<div class="newline"></div><span class="go">array([ 0.])</span>
<div class="newline"></div></pre></div>
</div>
<p>Tenga en cuenta que sólo una raíz puede ser encontrada. Una inspeción a la gráfica de <tt class="docutils literal"><span class="pre">f</span></tt> revela que hay una segunda raíz alrededor de -2.5. Encontramos el valor exacto de la misma mediante un ajuste a la estimación inicial:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">root2</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">root2</span>
<div class="newline"></div><span class="go">array([-2.47948183])</span>
<div class="newline"></div></pre></div>
</div>
<p><strong>Ajuste de curvas</strong></p>
<p>Supongamos que tenemos datos de una muestra de <tt class="docutils literal"><span class="pre">f</span></tt> con un poco de ruido:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">xdata</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>Ahora bien, si se conoce la forma funcional de la función de la cual las muestras fueron dibujadas (<tt class="docutils literal"><span class="pre">x^2</span> <span class="pre">+</span> <span class="pre">sin(x)</span></tt> en este caso), pero no la amplitud de los términos, puede ser encontrados mediante una ajuste por mínimos cuadrados. Primero tenemos que definir la funcionar a ajustar</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>Entonces podemos usar <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html#scipy.optimize.curve_fit" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.optimize.curve_fit()</span></tt></a> para encontrar <tt class="docutils literal"><span class="pre">a</span></tt> y <tt class="docutils literal"><span class="pre">b</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="p">,</span> <span class="n">params_covariance</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">curve_fit</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">guess</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">params</span>
<div class="newline"></div><span class="go">array([ 0.99925147,  9.76065551])</span>
<div class="newline"></div></pre></div>
</div>
<p>Ahora hemos encontrado los mínimos y las raíces de <tt class="docutils literal"><span class="pre">f</span></tt> y usando un ajuste de la curva, ponemos todos los resultados juntos en un gráfico:</p>
<p>[<a class="reference external" href="../plot_directive/pyplots/scipy_optimize_example2.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/scipy_optimize_example2.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/scipy_optimize_example2.pdf">pdf</a>]</p>
<img alt="../_images/scipy_optimize_example2.png" src="../_images/scipy_optimize_example2.png" />
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">En scipy &gt;= 0.11 se unificaron las interfaces para todos los algoritmos de minimización y búsqueda de raices están disponibles en <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.optimize.minimize()</span></tt></a>, <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize_scalar.html#scipy.optimize.minimize_scalar" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.optimize.minimize_scalar()</span></tt></a> y <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html#scipy.optimize.root" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.optimize.root()</span></tt></a>. Se permite comparar fácilmente diferentes algoritmos a través de la palabra clave <tt class="docutils literal"><span class="pre">method</span></tt>.
Usted puede encontrar algoritmos con las mismas funcionalidades para problemas multi-dimensional en <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/optimize.html#scipy.optimize" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.optimize</span></tt></a>.</p>
</div>
<div class="green topic">
<p class="topic-title first">Ejercicio: Ajuste de datos de temperatura</p>
<p>Las temperaturas extremas en Alaska para cada mes, a partir de enero (en grados centígrados)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">max</span><span class="p">:</span>  <span class="mi">17</span><span class="p">,</span>  <span class="mi">19</span><span class="p">,</span>  <span class="mi">21</span><span class="p">,</span>  <span class="mi">28</span><span class="p">,</span>  <span class="mi">33</span><span class="p">,</span>  <span class="mi">38</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span>  <span class="mi">37</span><span class="p">,</span>  <span class="mi">31</span><span class="p">,</span>  <span class="mi">23</span><span class="p">,</span>  <span class="mi">19</span><span class="p">,</span>  <span class="mi">18</span>
<div class="newline"></div><span class="nb">min</span><span class="p">:</span> <span class="o">-</span><span class="mi">62</span><span class="p">,</span> <span class="o">-</span><span class="mi">59</span><span class="p">,</span> <span class="o">-</span><span class="mi">56</span><span class="p">,</span> <span class="o">-</span><span class="mi">46</span><span class="p">,</span> <span class="o">-</span><span class="mi">32</span><span class="p">,</span> <span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">46</span><span class="p">,</span> <span class="o">-</span><span class="mi">52</span><span class="p">,</span> <span class="o">-</span><span class="mi">58</span>
<div class="newline"></div></pre></div>
</div>
<ol class="arabic simple">
<li>Grafique las temperaturas extremas.</li>
<li>Definir una función que puede describir las temperaturas min y máx.
Sugerencia: esta función tiene un periodo de 1 año.
Sugerencia: incluir un tiempo compensado.</li>
<li>Ajuste esta función a los datos con <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html#scipy.optimize.curve_fit" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.optimize.curve_fit()</span></tt></a>.</li>
<li>Graficar el resultado. El ajuste es razonable? Si no, por qué?</li>
<li>Si el tiempo no es compensado el ajuste de las temperaturas mínima y máxima tiene la misma exactitud?</li>
</ol>
</div>
<div class="green topic">
<p class="topic-title first">Ejercicio: Minimización 2-D</p>
<p>[<a class="reference external" href="../plot_directive/pyplots/scipy_optimize_sixhump.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/scipy_optimize_sixhump.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/scipy_optimize_sixhump.pdf">pdf</a>]</p>
<img alt="../_images/scipy_optimize_sixhump.png" src="../_images/scipy_optimize_sixhump.png" />
<p>La función six-hump camelback</p>
<div class="math">
<p><img src="../_images/math/a15fd87c4934c2530d57ccae635f1e53791a5187.png" alt="f(x, y) = (4 - 2.1x^2 + \frac{x^4}{3})x^2 + xy + (4y^2 - 4)y^2"/></p>
</div><p>tiene múltiples mınimos globales y locales. Encuentre los mínimos globales de esta función.</p>
<p>Sugerencia:</p>
<ul class="simple">
<li>Puede restringir las variables a <tt class="docutils literal"><span class="pre">-2</span> <span class="pre">&lt;</span> <span class="pre">x</span> <span class="pre">&lt;</span> <span class="pre">2</span></tt> y <tt class="docutils literal"><span class="pre">-1</span> <span class="pre">&lt;</span> <span class="pre">y</span> <span class="pre">&lt;</span> <span class="pre">1</span></tt>.</li>
<li>Use <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="(in NumPy v1.7)"><tt class="xref py py-func docutils literal"><span class="pre">numpy.meshgrid()</span></tt></a> y <tt class="xref py py-func docutils literal"><span class="pre">pylab.imshow()</span></tt> para encontrar visualmente las regiones.</li>
<li>Use <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fmin_bfgs.html#scipy.optimize.fmin_bfgs" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.optimize.fmin_bfgs()</span></tt></a> o otro minimizador multidimensional.</li>
</ul>
<p>Cuántos mínimos globales hay, y cuál es el valor de la función en esos puntos? Qué sucede con una estimación inicial de <tt class="docutils literal"><span class="pre">(x,</span> <span class="pre">y)</span> <span class="pre">=</span> <span class="pre">(0,</span> <span class="pre">0)</span></tt>?</p>
<p>Ver el sumario de ejercicios en <a class="reference internal" href="summary-exercises/optimize-fit.html#summary-exercise-optimize"><em>Non linear least squares curve fitting: application to point extraction in topographical lidar data</em></a> para ejemplos más avanzados.</p>
</div>
</div>
<div class="section" id="estadistica-y-numeros-aleatorios-scipy-stats">
<h2><a class="toc-backref" href="#id6">1.5.6. Estadística y números aleatorios: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/stats.html#scipy.stats" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.stats</span></tt></a></a><a class="headerlink" href="#estadistica-y-numeros-aleatorios-scipy-stats" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El módulo <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/stats.html#scipy.stats" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.stats</span></tt></a> contiene herramientas estadísticas y probabilísticas
descripciones de procesos aleatorios. Generadores de números aleatorios para diferentes
procesos aleatorios se puede encontrar en <tt class="xref py py-mod docutils literal"><span class="pre">numpy.random</span></tt> .</p>
<div class="section" id="histograma-y-la-funcion-de-densidad-de-probabilidad">
<h3>1.5.6.1. Histograma y la función de densidad de probabilidad<a class="headerlink" href="#histograma-y-la-funcion-de-densidad-de-probabilidad" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Mediante observaciones de un proceso aleatorio, su histograma es un estimador del proceso aleatorio PDF (probability density function):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span>
<div class="newline"></div><span class="go">array([-4, -3, -2, -1,  0,  1,  2,  3,  4])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">histogram</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span>
<div class="newline"></div><span class="go">array([-3.5, -2.5, -1.5, -0.5,  0.5,  1.5,  2.5,  3.5])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>  <span class="c"># norm is a distribution</span>
<div class="newline"></div></pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">histogram</span><span class="p">)</span>
<div class="newline"></div><span class="gp">In [2]: </span><span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>[<a class="reference external" href="../plot_directive/pyplots/normal_distribution.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/normal_distribution.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/normal_distribution.pdf">pdf</a>]</p>
<a class="reference internal image-reference" href="../_images/normal_distribution.png"><img alt="../_images/normal_distribution.png" src="../_images/normal_distribution.png" style="width: 308.0px; height: 252.0px;" /></a>
<p>Si sabemos que el proceso aleatorio pertenece a una determinada familia de procesos aleatorios, tales como procesos normales, podemos hacer un ajuste de máxima credibilidad de las observaciones para estimar los parámetros de la distribución subyacente. Aquí ajustamos a un proceso normal los datos observados</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">loc</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">loc</span>     
<div class="newline"></div><span class="go">-0.045256707490...</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">std</span>     
<div class="newline"></div><span class="go">0.9870331586690...</span>
<div class="newline"></div></pre></div>
</div>
<div class="green topic">
<p class="topic-title first">Ejercicio: Distribuciones de probabilidad</p>
<p>Generar 1000 variables aleatorias desde una distribución gamma con un parámetro de forma igual a 1, despues graficar el histograma de las muestras. Puede graficar la pdf de arriba (debe coincidir)?</p>
<p>Adicional: las distribuciones tienen una serie de métodos útiles. Explore la documentación o mediante la implementación del tabulador IPython. Puede encontrar el parámetro de forma de 1 vuelta usando el método <tt class="docutils literal"><span class="pre">fit</span></tt> para variables aleatorias?</p>
</div>
</div>
<div class="section" id="percentiles">
<h3>1.5.6.2. Percentiles<a class="headerlink" href="#percentiles" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La mediana es el valor situado al medio de las observaciones por debajo y arriba</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>     
<div class="newline"></div><span class="go">-0.058028034...</span>
<div class="newline"></div></pre></div>
</div>
<p>También se conoce como el percentil 50, porque el 50 % de las observaciones están por debajo</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>     
<div class="newline"></div><span class="go">-0.0580280347...</span>
<div class="newline"></div></pre></div>
</div>
<p>Del mismo modo, podemos calcular el percentil 90</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>     
<div class="newline"></div><span class="go">1.231593551...</span>
<div class="newline"></div></pre></div>
</div>
<p>El percentil es un estimador de una CDF: función de distribución acumulada (cumulative distribution function).</p>
</div>
<div class="section" id="pruebas-estadisticas">
<h3>1.5.6.3. Pruebas estadísticas<a class="headerlink" href="#pruebas-estadisticas" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Una prueba estadística es un indicador de decisión. Por ejemplo, si tenemos dos
series de observaciones, que suponemos se generan a partir de una distribución normal, podemos utilizar la <a class="reference external" href="http://es.wikipedia.org/wiki/Prueba_t_de_Student">Prueba t de Student</a> para decidir si los dos conjuntos de observaciones son significativamente diferentes</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>   
<div class="newline"></div><span class="go">(-3.75832707..., 0.00027786...)</span>
<div class="newline"></div></pre></div>
</div>
<p>La salida resultante se compone de:</p>
<ul class="simple">
<li>El valor estadístico T: es un número cuyo signo es proporcional a la diferencia entre los dos procesos aleatorios y la magnitud está relacionada a cuanto diferen.</li>
<li>El <em>valor p</em>: la probabilidad de que ambos procesos sean idénticos. Si es cercano a 1, los dos procesos son casi con toda seguridad idénticos. Cuanto más cercano sea a cero, lo más probable es que los procesos tengan diferentes medias.</li>
</ul>
</div>
</div>
<div class="section" id="interpolacion-scipy-interpolate">
<h2><a class="toc-backref" href="#id7">1.5.7. Interpolación: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/interpolate.html#scipy.interpolate" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.interpolate</span></tt></a></a><a class="headerlink" href="#interpolacion-scipy-interpolate" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El módulo <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/interpolate.html#scipy.interpolate" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.interpolate</span></tt></a> es útil para ajustar una función a partir de datos experimental y evaluar los puntos que se requieren. El módulo se basa en <a class="reference external" href="http://www.netlib.org/dierckx/index.html">FITPACK Fortran subroutines</a> del proyecto <a class="reference external" href="http://www.netlib.org">netlib</a>.</p>
<p>Suponiendo que los datos experimentales son cercanos a una función seno</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">measured_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">measures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">measured_time</span><span class="p">)</span> <span class="o">+</span> <span class="n">noise</span>
<div class="newline"></div></pre></div>
</div>
<p>La clase <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp1d.html#scipy.interpolate.interp1d" title="(in SciPy v0.12)"><tt class="xref py py-class docutils literal"><span class="pre">scipy.interpolate.interp1d</span></tt></a> puede construir una función de interpolación lineal</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linear_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">measured_time</span><span class="p">,</span> <span class="n">measures</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>La instancia <tt class="xref py py-obj docutils literal"><span class="pre">scipy.interpolate.linear_interp</span></tt> puede evaluarlo para un tiempo requerido</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">computed_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linear_results</span> <span class="o">=</span> <span class="n">linear_interp</span><span class="p">(</span><span class="n">computed_time</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>La interpolación cúbica puede seleccionarse al proporcionar al argumento opcional la palabra clave <tt class="docutils literal"><span class="pre">kind</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cubic_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">measured_time</span><span class="p">,</span> <span class="n">measures</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">&#39;cubic&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">cubic_results</span> <span class="o">=</span> <span class="n">cubic_interp</span><span class="p">(</span><span class="n">computed_time</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>Los resultados se muestran en la siguiente figura creada con Matplotlib:</p>
<p>[<a class="reference external" href="../plot_directive/pyplots/scipy_interpolation.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/scipy_interpolation.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/scipy_interpolation.pdf">pdf</a>]</p>
<img alt="../_images/scipy_interpolation.png" src="../_images/scipy_interpolation.png" />
<p><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp2d.html#scipy.interpolate.interp2d" title="(in SciPy v0.12)"><tt class="xref py py-class docutils literal"><span class="pre">scipy.interpolate.interp2d</span></tt></a> es similar a <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp1d.html#scipy.interpolate.interp1d" title="(in SciPy v0.12)"><tt class="xref py py-class docutils literal"><span class="pre">scipy.interpolate.interp1d</span></tt></a>, pero para arreglos 2-D. Tenga en cuenta que para los valores <tt class="xref py py-obj docutils literal"><span class="pre">interp</span></tt>, el tiempo calculado debe permanecer dentro del intervalo de tiempo medido. Ver el sumario de ejercicios <a class="reference internal" href="summary-exercises/stats-interpolate.html#summary-exercise-stat-interp"><em>Maximum wind speed prediction at the Sprogø station</em></a> para un ejemplo más avanzado de interpolación con splines.</p>
</div>
<div class="section" id="integracion-numerica-scipy-integrate">
<h2><a class="toc-backref" href="#id8">1.5.8. Integración numérica: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/integrate.html#scipy.integrate" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.integrate</span></tt></a></a><a class="headerlink" href="#integracion-numerica-scipy-integrate" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La rutina de integración más genérica es <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.integrate.quad()</span></tt></a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">res</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>Otros esquemas de integración están disponibles como <tt class="docutils literal"><span class="pre">fixed_quad</span></tt>,
<tt class="docutils literal"><span class="pre">quadrature</span></tt>, <tt class="docutils literal"><span class="pre">romberg</span></tt>.</p>
<p><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/integrate.html#scipy.integrate" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.integrate</span></tt></a> también cuenta con rutinas para integrar Ecuaciones Diferenciales Ordinarias (ODE). En particular, <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html#scipy.integrate.odeint" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.integrate.odeint()</span></tt></a> es un integrador de propósito general utilizando LSODA (Solucionador Livermore para Ecuaciones Diferenciales ordinarias con método Automático de conmutación
para problemas rígidos y no rígidos), consulte <a class="reference external" href="http://people.sc.fsu.edu/~jburkardt/f77_src/odepack/odepack.html">ODEPACK Fortran library</a> para más detalles.</p>
<p><tt class="docutils literal"><span class="pre">odeint</span></tt> resuelve sistemas de ecuaciones diferenciales ordinarias de primer orden de la forma</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">dy</span><span class="o">/</span><span class="n">dt</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="o">..</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span><span class="o">...</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>A modo de introducción, vamos a resolver la ecuación diferencial ordinaria <tt class="docutils literal"><span class="pre">dy/dt</span> <span class="pre">=</span> <span class="pre">-2y</span></tt> para <tt class="docutils literal"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">0</span> <span class="pre">..</span> <span class="pre">4</span></tt> , con la condición inicial <tt class="docutils literal"><span class="pre">y(t=0)</span> <span class="pre">=</span> <span class="pre">1</span></tt>. Primero se debe calcular la derivada de la función en una posición definida</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">calc_derivative</span><span class="p">(</span><span class="n">ypos</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">counter_arr</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="n">counter_arr</span> <span class="o">+=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ypos</span>
<div class="newline"></div><span class="gp">...</span>
<div class="newline"></div></pre></div>
</div>
<p>El argumento adicional <tt class="docutils literal"><span class="pre">counter_arr</span></tt> se ha añadido para mostrar que la
función puede ser llamada varias veces para un solo paso de tiempo, hasta que el solucionador llege a converger. La matriz de contadores se define como</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">counter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>A continuación se calcula la trayectoria</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">time_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">yvec</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">calc_derivative</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">time_vec</span><span class="p">,</span>
<div class="newline"></div><span class="gp">... </span>                    <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">counter</span><span class="p">,),</span> <span class="n">full_output</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>La función derivada ha sido llamada más de 40 veces (el número de pasos de tiempo)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">counter</span>
<div class="newline"></div><span class="go">array([129], dtype=uint16)</span>
<div class="newline"></div></pre></div>
</div>
<p>y el número acumulado de iteraciones para cada uno de los primeros 10 pasos de tiempo
puede obtenerse con</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">info</span><span class="p">[</span><span class="s">&#39;nfe&#39;</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span>
<div class="newline"></div><span class="go">array([31, 35, 43, 49, 53, 57, 59, 63, 65, 69], dtype=int32)</span>
<div class="newline"></div></pre></div>
</div>
<p>Tenga en cuenta que el solucionador requiere más iteraciones para la primera etapa de tiempo. La solución de la trayectoria <tt class="docutils literal"><span class="pre">yvec</span></tt> puede ahora ser graficada:</p>
<p>[<a class="reference external" href="../plot_directive/pyplots/odeint_introduction.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/odeint_introduction.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/odeint_introduction.pdf">pdf</a>]</p>
<a class="reference internal image-reference" href="../_images/odeint_introduction.png"><img alt="../_images/odeint_introduction.png" src="../_images/odeint_introduction.png" style="width: 308.0px; height: 252.0px;" /></a>
<p>Otro ejemplo con <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html#scipy.integrate.odeint" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.integrate.odeint()</span></tt></a> será un oscilador amortiguado masa-resorte (oscilador de segundo orden). La posición de la masa unida a un resorte obedece
la ecuación diferencial de segundo orden <tt class="docutils literal"><span class="pre">y''</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">eps</span> <span class="pre">wo</span> <span class="pre">y'</span> <span class="pre">+</span> <span class="pre">wo^2</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">0</span></tt> con <tt class="docutils literal"><span class="pre">wo^2</span> <span class="pre">=</span> <span class="pre">k/m</span></tt> siendo <tt class="docutils literal"><span class="pre">k</span></tt> la constante del resorte , <tt class="docutils literal"><span class="pre">m</span></tt> la masa y <tt class="docutils literal"><span class="pre">eps</span> <span class="pre">=</span> <span class="pre">c/(2</span> <span class="pre">m</span> <span class="pre">wo)</span></tt> siendo <tt class="docutils literal"><span class="pre">c</span></tt> el coeficiente de amortiguamiento. Para este ejemplo, elegimos los parámetros</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mass</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c"># kg</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">kspring</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c"># N/m</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">cviscous</span> <span class="o">=</span> <span class="mf">0.4</span>  <span class="c"># N s/m</span>
<div class="newline"></div></pre></div>
</div>
<p>por lo que el sistema es subamortiguado, porque</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">eps</span> <span class="o">=</span> <span class="n">cviscous</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mass</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">kspring</span><span class="o">/</span><span class="n">mass</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">eps</span> <span class="o">&lt;</span> <span class="mi">1</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>Para usar el solucionador <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html#scipy.integrate.odeint" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.integrate.odeint()</span></tt></a> la ecuación de segundo orden debe ser transformado en un sistema de dos ecuaciones de primer orden mediante el vector <tt class="docutils literal"><span class="pre">Y</span> <span class="pre">=</span> <span class="pre">(y,</span> <span class="pre">y')</span></tt>. Serás conveniente definir <tt class="docutils literal"><span class="pre">nu</span> <span class="pre">=</span> <span class="pre">2</span> <span class="pre">eps</span> <span class="pre">*</span> <span class="pre">wo</span> <span class="pre">=</span> <span class="pre">c</span> <span class="pre">/</span> <span class="pre">m</span></tt> y <tt class="docutils literal"><span class="pre">om</span> <span class="pre">=</span> <span class="pre">wo^2</span> <span class="pre">=</span> <span class="pre">k/m</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">nu_coef</span> <span class="o">=</span> <span class="n">cviscous</span> <span class="o">/</span> <span class="n">mass</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">om_coef</span> <span class="o">=</span> <span class="n">kspring</span> <span class="o">/</span> <span class="n">mass</span>
<div class="newline"></div></pre></div>
</div>
<p>La función que calculará la velocidad y la aceleración será</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">calc_deri</span><span class="p">(</span><span class="n">yvec</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">nuc</span><span class="p">,</span> <span class="n">omc</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="n">yvec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">nuc</span> <span class="o">*</span> <span class="n">yvec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omc</span> <span class="o">*</span> <span class="n">yvec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<div class="newline"></div><span class="gp">...</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">time_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">yarr</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">calc_deri</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">time_vec</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">nu_coef</span><span class="p">,</span> <span class="n">om_coef</span><span class="p">))</span>
<div class="newline"></div></pre></div>
</div>
<p>La posición final y la velocidad se muestran en la siguiente figura creada con Matplotlib:</p>
<p>[<a class="reference external" href="../plot_directive/pyplots/odeint_damped_spring_mass.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/odeint_damped_spring_mass.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/odeint_damped_spring_mass.pdf">pdf</a>]</p>
<a class="reference internal image-reference" href="../_images/odeint_damped_spring_mass.png"><img alt="../_images/odeint_damped_spring_mass.png" src="../_images/odeint_damped_spring_mass.png" style="width: 308.0px; height: 252.0px;" /></a>
<p>Scipy no tiene solucionadores de ecuaciones diferenciales parciales (PDE). Algunos paquetes Python para la resolver PDE están disponibles, tales como <a class="reference external" href="http://www.ctcms.nist.gov/fipy/">fipy</a> o <a class="reference external" href="http://code.google.com/p/sfepy/">SfePy</a>.</p>
</div>
<div class="section" id="procesamiento-de-senales-scipy-signal">
<h2><a class="toc-backref" href="#id9">1.5.9. Procesamiento de señales: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/signal.html#scipy.signal" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.signal</span></tt></a></a><a class="headerlink" href="#procesamiento-de-senales-scipy-signal" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<div class="newline"></div></pre></div>
</div>
<ul>
<li><p class="first"><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.detrend.html#scipy.signal.detrend" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.signal.detrend()</span></tt></a>: eliminar la tendencia lineal de la señal</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<div class="newline"></div><span class="n">x</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<div class="newline"></div><span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>[<a class="reference external" href="../plot_directive/pyplots/demo_detrend.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/demo_detrend.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/demo_detrend.pdf">pdf</a>]</p>
<a class="reference internal image-reference" href="../_images/demo_detrend.png"><img alt="../_images/demo_detrend.png" src="../_images/demo_detrend.png" style="width: 308.0px; height: 252.0px;" /></a>
</li>
<li><p class="first"><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.resample.html#scipy.signal.resample" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.signal.resample()</span></tt></a>: remuestrea una señal a <tt class="xref py py-obj docutils literal"><span class="pre">n</span></tt> puntos usando FFT.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<div class="newline"></div><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<div class="newline"></div><span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="n">signal</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="s">&#39;ko&#39;</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>[<a class="reference external" href="../plot_directive/pyplots/demo_resample.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/demo_resample.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/demo_resample.pdf">pdf</a>]</p>
<a class="reference internal image-reference" href="../_images/demo_resample.png"><img alt="../_images/demo_resample.png" src="../_images/demo_resample.png" style="width: 308.0px; height: 252.0px;" /></a>
<p>Note como en el lado de la ventana del remuestreo es menos precisa y tiene un efecto de ondulación.</p>
</li>
<li><p class="first"><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/signal.html#scipy.signal" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.signal</span></tt></a> tiene muchas funciones como: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.hamming.html#scipy.signal.hamming" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.signal.hamming()</span></tt></a>,
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.bartlett.html#scipy.signal.bartlett" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.signal.bartlett()</span></tt></a>, <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.blackman.html#scipy.signal.blackman" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.signal.blackman()</span></tt></a>...</p>
</li>
<li><p class="first"><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/signal.html#scipy.signal" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.signal</span></tt></a> tiene filtros (median filter <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.medfilt.html#scipy.signal.medfilt" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.signal.medfilt()</span></tt></a>,
Wiener <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.wiener.html#scipy.signal.wiener" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.signal.wiener()</span></tt></a>), discutiremos esto en la sección de imagen.</p>
</li>
</ul>
</div>
<div class="section" id="procesamiento-de-imagenes-scipy-ndimage">
<h2><a class="toc-backref" href="#id10">1.5.10. Procesamiento de imágenes: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/ndimage.html#scipy.ndimage" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.ndimage</span></tt></a></a><a class="headerlink" href="#procesamiento-de-imagenes-scipy-ndimage" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El submódulo dedicada al procesamiento de imágenes en scipy es <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/ndimage.html#scipy.ndimage" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.ndimage</span></tt></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">ndimage</span>
<div class="newline"></div></pre></div>
</div>
<p>Rutinas de procesamiento de imágenes pueden ser clasificadas de acuerdo a la categoría de procesamiento que realizan.</p>
<div class="section" id="transformaciones-geometricas-en-imagenes">
<h3>1.5.10.1. Transformaciones geométricas en imágenes<a class="headerlink" href="#transformaciones-geometricas-en-imagenes" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Cambio de orientación, resolución, ..</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">misc</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">lena</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">lena</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">shifted_lena</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">lena</span><span class="p">,</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">shifted_lena2</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">lena</span><span class="p">,</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rotated_lena</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">lena</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_lena</span> <span class="o">=</span> <span class="n">lena</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">:</span><span class="o">-</span><span class="mi">50</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">zoomed_lena</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="n">lena</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">zoomed_lena</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="go">(1024, 1024)</span>
<div class="newline"></div></pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/lena_transforms.png"><img alt="../_images/lena_transforms.png" src="../_images/lena_transforms.png" style="width: 903.0px; height: 186.2px;" /></a>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [35]: </span><span class="n">subplot</span><span class="p">(</span><span class="mi">151</span><span class="p">)</span>
<div class="newline"></div><span class="gr">Out[35]: </span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x925f46c</span><span class="o">&gt;</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">In [36]: </span><span class="n">pl</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">shifted_lena</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
<div class="newline"></div><span class="gr">Out[36]: </span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">AxesImage</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x9593f6c</span><span class="o">&gt;</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">In [37]: </span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;off&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gr">Out[37]: </span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">511.5</span><span class="p">,</span> <span class="mf">511.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">In [39]: </span><span class="c"># etc.</span>
<div class="newline"></div></pre></div>
</div>
</div>
<div class="section" id="filtrado-de-imagenes">
<h3>1.5.10.2. Filtrado de imágenes<a class="headerlink" href="#filtrado-de-imagenes" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">misc</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">lena</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">lena</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">noisy_lena</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">lena</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">noisy_lena</span> <span class="o">+=</span> <span class="n">lena</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">*</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">lena</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">blurred_lena</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">noisy_lena</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">median_lena</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">median_filter</span><span class="p">(</span><span class="n">blurred_lena</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">wiener_lena</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">wiener</span><span class="p">(</span><span class="n">blurred_lena</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<div class="newline"></div></pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/filtered_lena.png"><img alt="../_images/filtered_lena.png" src="../_images/filtered_lena.png" style="width: 923.2px; height: 249.6px;" /></a>
</div>
<p>Muchos otros filtros en <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/ndimage.html#scipy.ndimage.filters" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.ndimage.filters</span></tt></a> y <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/signal.html#scipy.signal" title="(in SciPy v0.12)"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.signal</span></tt></a> se puede aplicar a las imágenes.</p>
<div class="green topic">
<p class="topic-title first">Ejercicio</p>
<p>Comparar histogramas para las diferentes imágenes filtradas.</p>
</div>
</div>
<div class="section" id="morfologia-matematica">
<h3>1.5.10.3. Morfología matemática<a class="headerlink" href="#morfologia-matematica" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Morfología matemática es una teoría derivada de teória de conjuntos. Se caracterizan y transforman las estructuras geométricas. En particular las imágenes binarias (blanco y negro), se pueden transformar mediante esta teoría: los conjuntos para ser transformados son los grupos de píxeles vecinos de valor no cero. La teoría también se extendió a las imágenes en escala de grises.</p>
<img alt="../_images/morpho_mat1.png" class="align-center" src="../_images/morpho_mat1.png" />
<p>Operaciones elementales matemático-morfologícas usan un <em>elemento estructurante</em>
con el fin de modificar otras estructuras geométricas.</p>
<p>Primero vamos a generar un elemento estructurante</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">el</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">generate_binary_structure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">el</span>
<div class="newline"></div><span class="go">array([[False, True, False],</span>
<div class="newline"></div><span class="go">       [True, True, True],</span>
<div class="newline"></div><span class="go">       [False, True, False]], dtype=bool)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">el</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 1, 0],</span>
<div class="newline"></div><span class="go">       [1, 1, 1],</span>
<div class="newline"></div><span class="go">       [0, 1, 0]])</span>
<div class="newline"></div></pre></div>
</div>
<ul>
<li><p class="first"><strong>Erosion</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c">#Erosión elimina los objetos más pequeños que la estructura</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first"><strong>Dilatación</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[ 0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.,  1.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.,  0.,  0.,  0.]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[ 0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.,  1.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  1.,  1.,  1.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.,  1.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.,  0.,  0.,  0.]])</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first"><strong>Apertura</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 1]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c">#Apertura elimina objetos pequeños</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c"># Opening can also smooth corners</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0]])</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first"><strong>Cierre:</strong> <tt class="docutils literal"><span class="pre">ndimage.binary_closing</span></tt></p>
</li>
</ul>
<div class="green topic">
<p class="topic-title first">Ejercicio</p>
<p>Compruebe que las cantidades iniciales a erosionar, se dilataran.</p>
</div>
<p>Una operación de apertura elimina estructuras pequeñas, mientras que una operación de cierre rellena pequeños agujeros. Por tanto, estas operaciones pueden ser utilizados para &#8220;limpiar&#8221; una imagen.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+=</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">a</span><span class="o">&gt;=</span><span class="mf">0.5</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">opened_mask</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">closed_mask</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">binary_closing</span><span class="p">(</span><span class="n">opened_mask</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/morpho.png"><img alt="../_images/morpho.png" src="../_images/morpho.png" style="width: 866.25px; height: 225.0px;" /></a>
</div>
<div class="green topic">
<p class="topic-title first">Ejercicio</p>
<p>Compruebe que el área del cuadrado reconstruido es menor que el área del cuadrado inicial. (Lo contrario ocurriría si la etapa de cierre se realiza <em>antes</em> que la apertura).</p>
</div>
<p>Para imágenes <em>en escala de grises</em>, erosionar (respuesta a dilatar) equivale a la sustitución de un píxel por el valor mínimo (respuesta maximal) entre los píxeles incluidos en el elemento estructurante centrado en el píxel de interés.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 3, 3, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 1, 3, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 3, 3, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 3, 2, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 3, 3, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">grey_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 3, 2, 2, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div></pre></div>
</div>
</div>
<div class="section" id="mediciones-en-imagenes">
<h3>1.5.10.4. Mediciones en imágenes<a class="headerlink" href="#mediciones-en-imagenes" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Primero vamos a generar una imagen binaria sintética agradable.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">indices</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mf">50.</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="mf">50.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="mf">50.</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">sig</span> <span class="o">&gt;</span> <span class="mi">1</span>
<div class="newline"></div></pre></div>
</div>
<p>Ahora veremos variada información acerca de los objetos en la imagen</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="p">,</span> <span class="n">nb</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">nb</span>
<div class="newline"></div><span class="go">8</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">areas</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">labels</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">areas</span>
<div class="newline"></div><span class="go">array([ 190.,   45.,  424.,  278.,  459.,  190.,  549.,  424.])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">maxima</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">labels</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">maxima</span>
<div class="newline"></div><span class="go">array([  1.80238238,   1.13527605,   5.51954079,   2.49611818,</span>
<div class="newline"></div><span class="go">         6.71673619,   1.80238238,  16.76547217,   5.51954079])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">find_objects</span><span class="p">(</span><span class="n">labels</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span>
<div class="newline"></div><span class="go">[(slice(30L, 48L, None), slice(30L, 48L, None))]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sl</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">find_objects</span><span class="p">(</span><span class="n">labels</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pylab</span> <span class="kn">as</span> <span class="nn">pl</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">pl</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sig</span><span class="p">[</span><span class="n">sl</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>   
<div class="newline"></div><span class="go">&lt;matplotlib.image.AxesImage object at ...&gt;</span>
<div class="newline"></div></pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/measures.png"><img alt="../_images/measures.png" src="../_images/measures.png" style="width: 910.4px; height: 312.8px;" /></a>
</div>
<p>Ver el sumario de ejercicios en <a class="reference internal" href="summary-exercises/image-processing.html#summary-exercise-image-processing"><em>Image processing application: counting bubbles and unmolten grains</em></a> para una ejemplo más avanzado.</p>
</div>
</div>
<div class="section" id="sumario-de-ejercicios-para-computacion-cientifica">
<h2><a class="toc-backref" href="#id11">1.5.11. Sumario de ejercicios para computación científica</a><a class="headerlink" href="#sumario-de-ejercicios-para-computacion-cientifica" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El sumario de ejercicios utiliza principalmente Numpy, Scipy y Matplotlib. Se proporcionan algunos ejemplos de la vida real en computación científica con Python. Los fundamentos para trabajar con Numpy y Scipy fueron introducidos, se invita a el usuario interesado probar los ejercicios.</p>
<p><strong>Ejercicios:</strong></p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="summary-exercises/stats-interpolate.html">1.5.11.13. Maximum wind speed prediction at the Sprogø station</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary-exercises/optimize-fit.html">1.5.11.14. Non linear least squares curve fitting: application to point extraction in topographical lidar data</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary-exercises/image-processing.html">1.5.11.15. Image processing application: counting bubbles and unmolten grains</a></li>
</ul>
</div>
<p><strong>Soluciones propuestas:</strong></p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="summary-exercises/answers_image_processing.html">1.5.11.16. Example of solution for the image processing exercise: unmolten grains in glass</a></li>
</ul>
</div>
<p><div style="clear: both"></div></p>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="summary-exercises/stats-interpolate.html" title="1.5.11.13. Maximum wind speed prediction at the Sprogø station"
             >siguiente</a></li>
        <li class="right" >
          <a href="matplotlib/matplotlib.html" title="1.4. Matplotlib: Gráficas usando pylab"
             >anterior</a> |</li>
        <li><a href="../index.html">Scipy lecture notes</a> &raquo;</li>
          <li><a href="index.html" >1. Iniciandose en computación científica con Python</a> &raquo;</li>
     
    <!-- Insert a menu in the navigation bar -->
    <li class="left">
	<!-- On click toggle the 'tip' on or off-->
	<a onclick="$('.tip').each(function (index, obj) {
			    collapse_tip_div(obj);
		    });
		    $('.tip').addClass('collapsed');
		    $('.left').addClass('transparent');">
	<img src="../_static/minus.png"
         alt="Collapse to compact view" style="padding: 1ex;"/>
	<span class="hiddenlink">Collapse document to compact view</span>
    </a></li>

      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012,2013.
      Creado con <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>